<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.suny.association.mapper.PermissionAllotMapper">
    <resultMap id="BaseResultMap" type="com.suny.association.pojo.po.PermissionAllot">
        <id property="id" column="id"/>
        <association property="roleId" column="role_id" javaType="com.suny.association.pojo.po.Roles">
            <id column="role_id" property="roleId"/>
            <result column="role_name" property="roleName"/>
            <result column="role_description" property="description"/>
            <result column="role_create_time" property="createTime"/>
        </association>
        <collection property="permissionSet" column="permiss_id" ofType="com.suny.association.pojo.po.Permission">
            <id property="permissionId" column="permission_id"/>
            <result property="permissionName" column="permission_name"/>
            <result property="description" column="permission_description"/>
            <result property="createTime" column="create_time"/>
            <result property="permissionStatus" column="permission_status"/>
        </collection>
    </resultMap>

    <select id="queryAll" resultMap="BaseResultMap">
        SELECT
            r.role_id,
            r.role_name,
            r.role_description,
            p.permission_id,
            p.permission_name,
            p.permission_description,
            p.create_time,
            p.permission_status
        FROM
            roles r,
            permission_union_role pr,
            permission p
        WHERE pr.role_id = r.role_id
              AND
              pr.permiss_id = p.permission_id
    </select>
</mapper>